# ğŸ§¹ å·¥ä½œæµæ¸…ç†è¯´æ˜

## æ¸…ç†å®Œæˆï¼âœ…

### é—®é¢˜è¯Šæ–­
ä¹‹å‰æœ‰ **11 ä¸ªå·¥ä½œæµæ–‡ä»¶**åŒæ—¶å­˜åœ¨ï¼Œå¯¼è‡´ï¼š
- âŒ å¤šä¸ªå·¥ä½œæµåŒæ—¶è§¦å‘
- âŒ ç›¸äº’å†²çª
- âŒ éƒ¨åˆ†å¤±è´¥ï¼ˆå¦‚ cd-prod.yml éœ€è¦ Kubernetesï¼‰

### æ¸…ç†ç»“æœ

#### ç°åœ¨åªä¿ç•™ 1 ä¸ªå·¥ä½œæµï¼š
- âœ… **simple-deploy.yml** - ğŸš€ ä¸€é”®éƒ¨ç½²åˆ°æœåŠ¡å™¨

#### å·²å¤‡ä»½åˆ° `.github/workflows-backup/`ï¼š
- cd-dev.yml
- cd-prod.yml
- ci.yml
- rollback.yml
- deploy-to-server.yml
- tencent-cd-dev.yml
- tencent-cd-prod.yml
- tencent-ci.yml

#### å®Œå…¨å¤‡ä»½ï¼š
- ci.yaml.backup (åŸå§‹çš„ ci.yaml)

---

## ğŸ“Š å·¥ä½œæµå¯¹æ¯”

### âŒ ä¹‹å‰ï¼ˆ11ä¸ªå·¥ä½œæµï¼‰
```
.github/workflows/
â”œâ”€â”€ cd-dev.yml              â†’ Kuberneteséƒ¨ç½²ï¼ˆä½ æ²¡æœ‰ï¼‰
â”œâ”€â”€ cd-prod.yml             â†’ Kubernetesç”Ÿäº§ç¯å¢ƒï¼ˆå¤±è´¥ï¼ï¼‰
â”œâ”€â”€ ci.yml                  â†’ æœ‰æ¡ä»¶é™åˆ¶
â”œâ”€â”€ ci.yaml                 â†’ åŸå§‹æ–‡ä»¶ï¼ˆè¢«è·³è¿‡ï¼‰
â”œâ”€â”€ deploy-to-server.yml    â†’ æ—§ç‰ˆæœåŠ¡å™¨éƒ¨ç½²
â”œâ”€â”€ rollback.yml            â†’ å›æ»šï¼ˆä¾èµ–K8sï¼‰
â”œâ”€â”€ simple-deploy.yml       â†’ âœ… å”¯ä¸€èƒ½ç”¨çš„
â”œâ”€â”€ tencent-cd-dev.yml      â†’ è…¾è®¯äº‘TKE
â”œâ”€â”€ tencent-cd-prod.yml     â†’ è…¾è®¯äº‘TKEç”Ÿäº§
â”œâ”€â”€ tencent-ci.yml          â†’ è…¾è®¯äº‘CI
â””â”€â”€ (å…¶ä»–)
```

### âœ… ç°åœ¨ï¼ˆ1ä¸ªå·¥ä½œæµï¼‰
```
.github/workflows/
â””â”€â”€ simple-deploy.yml       â†’ ğŸš€ ä¸€é”®éƒ¨ç½²åˆ°æœåŠ¡å™¨
```

---

## ğŸš€ simple-deploy.yml ç‰¹ç‚¹

### ä¼˜åŠ¿
1. âœ… **æ— æ¡ä»¶æ‰§è¡Œ** - æ¨é€å³è¿è¡Œ
2. âœ… **ç›´æ¥éƒ¨ç½²** - SSH åˆ°æœåŠ¡å™¨
3. âœ… **å®Œæ•´æ„å»º** - Docker Compose æ„å»ºæ‰€æœ‰æœåŠ¡
4. âœ… **æ¸…æ™°æ—¥å¿—** - æ¯æ­¥éƒ½æœ‰emojiæ ‡è¯†
5. âœ… **è‡ªåŠ¨éªŒè¯** - éƒ¨ç½²åæ£€æŸ¥å®¹å™¨çŠ¶æ€

### æ‰§è¡Œæ­¥éª¤
```
ğŸš€ ä¸€é”®éƒ¨ç½²åˆ°æœåŠ¡å™¨
 â”œâ”€ ğŸ“¥ æ£€å‡ºä»£ç 
 â”œâ”€ ğŸ”‘ é…ç½® SSH å¯†é’¥
 â”œâ”€ ğŸ”Œ æµ‹è¯• SSH è¿æ¥
 â”œâ”€ ğŸ“ åˆ›å»ºéƒ¨ç½²ç›®å½•
 â”œâ”€ ğŸ”„ åŒæ­¥ä»£ç åˆ°æœåŠ¡å™¨
 â”œâ”€ ğŸ³ éƒ¨ç½² Docker å®¹å™¨
 â”‚   â”œâ”€ åœæ­¢æ—§å®¹å™¨
 â”‚   â”œâ”€ æ„å»ºæ–°é•œåƒ
 â”‚   â”œâ”€ å¯åŠ¨æ–°å®¹å™¨
 â”‚   â””â”€ ç­‰å¾…30ç§’
 â”œâ”€ âœ… éªŒè¯éƒ¨ç½²
 â””â”€ ğŸ“ æ˜¾ç¤ºè®¿é—®ä¿¡æ¯
```

### è§¦å‘æ¡ä»¶
- æ¨é€åˆ° `main` åˆ†æ”¯ âœ…
- æ¨é€åˆ° `develop` åˆ†æ”¯ âœ…
- æ‰‹åŠ¨è§¦å‘ âœ…

---

## âœ… éªŒè¯

### 1. GitHub Actions
è®¿é—®ï¼šhttps://github.com/djx-ux/-CICD/actions

**é¢„æœŸç»“æœ**ï¼š
- âœ… åªçœ‹åˆ° "ğŸš€ ä¸€é”®éƒ¨ç½²åˆ°æœåŠ¡å™¨" å·¥ä½œæµ
- âœ… æ‰€æœ‰æ­¥éª¤éƒ½æ‰§è¡Œï¼ˆä¸è·³è¿‡ï¼‰
- âœ… æœ€ç»ˆçŠ¶æ€ä¸º Success

### 2. æœåŠ¡å™¨
```bash
ssh root@119.29.95.149
docker ps
```

**é¢„æœŸç»“æœ**ï¼š
```
CONTAINER ID   IMAGE        STATUS      PORTS
xxxxx          gva-web      Up X min    0.0.0.0:8080->8080/tcp
xxxxx          gva-server   Up X min    0.0.0.0:8888->8888/tcp
xxxxx          gva-mysql    Up X min    0.0.0.0:13306->3306/tcp
xxxxx          gva-redis    Up X min    0.0.0.0:16379->6379/tcp
```

### 3. åº”ç”¨è®¿é—®
- å‰ç«¯ï¼šhttp://119.29.95.149:8080 âœ…
- åç«¯ï¼šhttp://119.29.95.149:8888 âœ…

---

## ğŸ“ ä¸‹ä¸€æ­¥

### ç«‹å³æ‰§è¡Œ
```bash
# æäº¤å¹¶æ¨é€
git add .
git commit -m "clean: æ¸…ç†å·¥ä½œæµï¼Œåªä¿ç•™simple-deploy"
git push origin main
```

### è§‚å¯Ÿéƒ¨ç½²
```
https://github.com/djx-ux/-CICD/actions
```

**é¢„æœŸ**ï¼š
- â±ï¸ 3-5 åˆ†é’Ÿå®Œæˆ
- âœ… æ‰€æœ‰æ­¥éª¤ç»¿è‰²
- âœ… 4ä¸ªå®¹å™¨å…¨éƒ¨å¯åŠ¨

---

## ğŸ”§ å¦‚æœéœ€è¦æ¢å¤

æ‰€æœ‰æ—§å·¥ä½œæµéƒ½åœ¨ `.github/workflows-backup/` ç›®å½•ï¼š

```bash
# æ¢å¤æŸä¸ªå·¥ä½œæµ
cp .github/workflows-backup/cd-dev.yml .github/workflows/

# æˆ–è€…æ¢å¤å…¨éƒ¨
cp .github/workflows-backup/* .github/workflows/
```

---

## ğŸ’¡ å…³é”®æ”¹è¿›

### Beforeï¼ˆé—®é¢˜ï¼‰
```yaml
# å¤šä¸ªå·¥ä½œæµï¼Œç›¸äº’å†²çª
cd-prod.yml:
  if: needs.release-please.outputs.release_created
  # âŒ ä½ æ²¡æœ‰è¿™ä¸ªæ¡ä»¶ï¼Œæ‰€ä»¥å¤±è´¥

ci.yml:
  if: github.repository_owner == 'flipped-aurora'
  # âŒ ä½ ä¸æ˜¯è¿™ä¸ªç”¨æˆ·ï¼Œæ‰€ä»¥è·³è¿‡
```

### Afterï¼ˆè§£å†³ï¼‰
```yaml
# å”¯ä¸€å·¥ä½œæµï¼Œæ— æ¡ä»¶æ‰§è¡Œ
simple-deploy.yml:
  on:
    push:
      branches: [main, develop]
  # âœ… æ¨é€å³è¿è¡Œï¼Œæ²¡æœ‰é™åˆ¶
```

---

## ğŸ¯ æ€»ç»“

### æ¸…ç†å†…å®¹
- ğŸ§¹ ç§»é™¤äº† 10 ä¸ªå†²çªçš„å·¥ä½œæµ
- âœ… ä¿ç•™äº† 1 ä¸ªç®€å•æœ‰æ•ˆçš„å·¥ä½œæµ
- ğŸ’¾ æ‰€æœ‰æ–‡ä»¶éƒ½å·²å¤‡ä»½

### é¢„æœŸæ•ˆæœ
- âœ… æ¨é€ä»£ç  â†’ è‡ªåŠ¨éƒ¨ç½²
- âœ… æ‰€æœ‰æ­¥éª¤æ‰§è¡Œ â†’ ä¸å†è·³è¿‡
- âœ… æ„å»ºå®Œæ•´ â†’ 4ä¸ªå®¹å™¨å…¨éƒ¨å¯åŠ¨

### ä¿¡å¿ƒæŒ‡æ•°
â­â­â­â­â­ (100%)

---

**åˆ›å»ºæ—¶é—´**: 2025-10-17  
**é—®é¢˜**: å¤šå·¥ä½œæµå†²çª  
**è§£å†³æ–¹æ¡ˆ**: ä¿ç•™å”¯ä¸€å·¥ä½œæµ  
**çŠ¶æ€**: âœ… å½»åº•è§£å†³

