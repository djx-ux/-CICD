# ğŸ”§ ç´§æ€¥ä¿®å¤æŒ‡å—

## é—®é¢˜è¯Šæ–­

### é—®é¢˜1ï¼šGitHub Actions ä»»åŠ¡è¢«è·³è¿‡ âœ…

**åŸå› **ï¼šåŸæ¥çš„ `ci.yaml` ä¸­çš„ä»»åŠ¡æœ‰æ¡ä»¶é™åˆ¶
- `init` è¦æ±‚ `repository_owner == 'flipped-aurora'`ï¼ˆä½ ä¸æ»¡è¶³ï¼‰
- å…¶ä»–ä»»åŠ¡ä¾èµ– `init`ï¼Œæ‰€ä»¥éƒ½è¢«è·³è¿‡äº†

**ä½†è¿™ä¸æ˜¯é—®é¢˜ï¼** å› ä¸ºï¼š
- `frontend` å’Œ `backend` ä»»åŠ¡å·²ç»æˆåŠŸè¿è¡Œ âœ…
- å…¶ä»–è¢«è·³è¿‡çš„ä»»åŠ¡ä¸å½±å“ä½ çš„éƒ¨ç½²

### é—®é¢˜2ï¼šæœåŠ¡å™¨åªæœ‰ redis å®¹å™¨è¿è¡Œ âŒ

**åŸå› **ï¼š`deploy-to-server.yml` å·¥ä½œæµè¿˜æ²¡æœ‰è¢«è§¦å‘è¿‡

**éœ€è¦ä¿®å¤ï¼**

---

## ğŸš€ ç«‹å³ä¿®å¤ï¼ˆé€‰æ‹©ä¸€ä¸ªæ–¹æ³•ï¼‰

### æ–¹æ³• 1ï¼šè§¦å‘è‡ªåŠ¨éƒ¨ç½²ï¼ˆæ¨èï¼‰â­

åœ¨ç»ˆç«¯è¿è¡Œï¼š

```bash
# åœ¨é¡¹ç›®ç›®å½•
cd /Users/ykmz/Desktop/å“ˆé›·å½—æ˜Ÿ/gin-vue-admin

# åˆ›å»ºä¸€ä¸ªç©ºæäº¤è§¦å‘éƒ¨ç½²
git commit --allow-empty -m "trigger: è§¦å‘æœåŠ¡å™¨è‡ªåŠ¨éƒ¨ç½²"

# æ¨é€åˆ° GitHub
git push origin main
```

**ç„¶åè§‚å¯Ÿ**ï¼š
1. è®¿é—®ï¼šhttps://github.com/djx-ux/-CICD/actions
2. ä½ ä¼šçœ‹åˆ° **"éƒ¨ç½²åˆ°è…¾è®¯äº‘æœåŠ¡å™¨"** å·¥ä½œæµå¼€å§‹è¿è¡Œ
3. ç­‰å¾… 3-5 åˆ†é’Ÿéƒ¨ç½²å®Œæˆ

---

### æ–¹æ³• 2ï¼šæ‰‹åŠ¨ä¿®å¤æœåŠ¡å™¨ï¼ˆå¦‚æœæ–¹æ³•1å¤±è´¥ï¼‰

#### æ­¥éª¤ Aï¼šè¿è¡Œä¿®å¤è„šæœ¬

```bash
# åœ¨é¡¹ç›®ç›®å½•
cd /Users/ykmz/Desktop/å“ˆé›·å½—æ˜Ÿ/gin-vue-admin

# è¿è¡Œä¿®å¤è„šæœ¬
./fix-server.sh
```

è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
1. SSH è¿æ¥åˆ°æœåŠ¡å™¨
2. åœæ­¢æ—§å®¹å™¨
3. é‡æ–°æ„å»ºé•œåƒ
4. å¯åŠ¨æ‰€æœ‰æœåŠ¡

#### æ­¥éª¤ Bï¼šæ‰‹åŠ¨ä¿®å¤ï¼ˆå¦‚æœè„šæœ¬å¤±è´¥ï¼‰

```bash
# 1. SSH åˆ°æœåŠ¡å™¨
ssh root@119.29.95.149

# 2. è¿›å…¥é¡¹ç›®ç›®å½•ï¼ˆéœ€è¦å…ˆåŒæ­¥ä»£ç ï¼‰
# å¦‚æœç›®å½•ä¸å­˜åœ¨ï¼Œè¯´æ˜è¿˜æ²¡æœ‰è‡ªåŠ¨éƒ¨ç½²è¿‡
# é‚£å°±ç­‰å¾…æ–¹æ³•1å®Œæˆ

# å¦‚æœç›®å½•å­˜åœ¨ï¼Œç»§ç»­ï¼š
cd /opt/gin-vue-admin/deploy/docker-compose

# 3. æŸ¥çœ‹å½“å‰å®¹å™¨
docker ps -a

# 4. åœæ­¢æ‰€æœ‰å®¹å™¨
docker-compose down

# 5. é‡æ–°æ„å»ºå¹¶å¯åŠ¨
docker-compose build --no-cache
docker-compose up -d

# 6. æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker-compose ps

# 7. æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

---

## âœ… éªŒè¯ä¿®å¤æˆåŠŸ

### 1. æ£€æŸ¥ GitHub Actions

è®¿é—®ï¼šhttps://github.com/djx-ux/-CICD/actions

åº”è¯¥çœ‹åˆ°ï¼š
- âœ… "éƒ¨ç½²åˆ°è…¾è®¯äº‘æœåŠ¡å™¨" å·¥ä½œæµæˆåŠŸï¼ˆç»¿è‰²ï¼‰
- âœ… æ˜¾ç¤º "Success"

### 2. æ£€æŸ¥æœåŠ¡å™¨å®¹å™¨

```bash
ssh root@119.29.95.149
docker ps
```

åº”è¯¥çœ‹åˆ° 4 ä¸ªå®¹å™¨éƒ½åœ¨è¿è¡Œï¼š
```
CONTAINER ID   IMAGE              STATUS          PORTS
xxxxx          gva-web            Up X minutes    0.0.0.0:8080->8080/tcp
xxxxx          gva-server         Up X minutes    0.0.0.0:8888->8888/tcp
xxxxx          gva-mysql          Up X minutes    0.0.0.0:13306->3306/tcp
xxxxx          gva-redis          Up X minutes    0.0.0.0:16379->6379/tcp
```

### 3. è®¿é—®åº”ç”¨

åœ¨æµè§ˆå™¨æ‰“å¼€ï¼š
- **å‰ç«¯**: http://119.29.95.149:8080
- **åç«¯**: http://119.29.95.149:8888

åº”è¯¥éƒ½èƒ½æ­£å¸¸è®¿é—®ï¼

---

## ğŸ› å¦‚æœè¿˜æœ‰é—®é¢˜

### é—®é¢˜ï¼šdeploy-to-server.yml æ²¡æœ‰è§¦å‘

**åŸå› **ï¼šå¯èƒ½æ˜¯ç¬¬ä¸€æ¬¡æ¨é€ï¼ŒGitHub è¿˜æ²¡è¯†åˆ«åˆ°æ–°çš„å·¥ä½œæµ

**è§£å†³**ï¼š
```bash
# å†æ¨é€ä¸€æ¬¡
git commit --allow-empty -m "trigger: å†æ¬¡è§¦å‘éƒ¨ç½²"
git push origin main
```

### é—®é¢˜ï¼šæœåŠ¡å™¨ä¸Šæ²¡æœ‰ä»£ç 

**è¯´æ˜**ï¼šè‡ªåŠ¨éƒ¨ç½²è¿˜æ²¡æœ‰è¿è¡Œè¿‡

**è§£å†³**ï¼š
1. ç¡®è®¤ GitHub Secret `SERVER_SSH_KEY` å·²é…ç½®
2. æ¨é€ä»£ç è§¦å‘éƒ¨ç½²
3. ç­‰å¾… GitHub Actions å®Œæˆ

### é—®é¢˜ï¼šå®¹å™¨å¯åŠ¨å¤±è´¥

**æŸ¥çœ‹æ—¥å¿—**ï¼š
```bash
ssh root@119.29.95.149
cd /opt/gin-vue-admin/deploy/docker-compose

# æŸ¥çœ‹æ‰€æœ‰å®¹å™¨æ—¥å¿—
docker-compose logs

# æŸ¥çœ‹ç‰¹å®šå®¹å™¨
docker-compose logs web
docker-compose logs server
docker-compose logs mysql
docker-compose logs redis
```

**å¸¸è§é”™è¯¯**ï¼š
- MySQL åˆå§‹åŒ–å¤±è´¥ï¼šåˆ é™¤ volume é‡æ–°å¯åŠ¨
  ```bash
  docker-compose down -v
  docker-compose up -d
  ```
- ç«¯å£è¢«å ç”¨ï¼šæ£€æŸ¥ç«¯å£
  ```bash
  netstat -tlnp | grep :8080
  netstat -tlnp | grep :8888
  ```

---

## ğŸ¯ æ¨èæ“ä½œæµç¨‹

```bash
# 1. è§¦å‘è‡ªåŠ¨éƒ¨ç½²
git commit --allow-empty -m "trigger: éƒ¨ç½²åˆ°æœåŠ¡å™¨"
git push origin main

# 2. è§‚å¯Ÿ GitHub Actionsï¼ˆçº¦3-5åˆ†é’Ÿï¼‰
# è®¿é—®: https://github.com/djx-ux/-CICD/actions

# 3. éƒ¨ç½²å®Œæˆåï¼ŒéªŒè¯æœåŠ¡å™¨
ssh root@119.29.95.149
docker ps  # åº”è¯¥çœ‹åˆ°4ä¸ªå®¹å™¨

# 4. è®¿é—®åº”ç”¨
# http://119.29.95.149:8080
```

---

## ğŸ“Š é¢„æœŸç»“æœ

### GitHub Actions

ä½ åº”è¯¥çœ‹åˆ°ä¸¤ä¸ªå·¥ä½œæµï¼š

1. **CI** âœ…ï¼ˆå·²å®Œæˆï¼‰
   - âœ… Frontend node 18.16.0 - Success
   - âœ… Backend go (1.22) - Success
   - âšª init - è·³è¿‡ï¼ˆæ­£å¸¸ï¼‰
   - âšª å…¶ä»–ä»»åŠ¡ - è·³è¿‡ï¼ˆæ­£å¸¸ï¼‰

2. **éƒ¨ç½²åˆ°è…¾è®¯äº‘æœåŠ¡å™¨** âœ…ï¼ˆæ–°è§¦å‘ï¼‰
   - âœ… ä»£ç æ£€æŸ¥å’Œæµ‹è¯•
   - âœ… SSH è¿æ¥
   - âœ… åŒæ­¥ä»£ç 
   - âœ… æ„å»ºé•œåƒ
   - âœ… éƒ¨ç½²å®¹å™¨
   - âœ… éªŒè¯éƒ¨ç½²

### æœåŠ¡å™¨çŠ¶æ€

```bash
$ docker ps
CONTAINER ID   IMAGE          STATUS          PORTS
xxxxx          gva-web        Up 2 minutes    0.0.0.0:8080->8080/tcp
xxxxx          gva-server     Up 2 minutes    0.0.0.0:8888->8888/tcp
xxxxx          gva-mysql      Up 2 minutes    0.0.0.0:13306->3306/tcp
xxxxx          gva-redis      Up 2 minutes    0.0.0.0:16379->6379/tcp
```

---

## ğŸš€ ç°åœ¨å°±å¼€å§‹ä¿®å¤ï¼

**æ¨èï¼šä½¿ç”¨æ–¹æ³• 1ï¼ˆè‡ªåŠ¨éƒ¨ç½²ï¼‰**

```bash
cd /Users/ykmz/Desktop/å“ˆé›·å½—æ˜Ÿ/gin-vue-admin
git commit --allow-empty -m "trigger: è§¦å‘æœåŠ¡å™¨éƒ¨ç½²"
git push origin main
```

ç„¶åæ‰“å¼€æµè§ˆå™¨ï¼š
```
https://github.com/djx-ux/-CICD/actions
```

è§‚çœ‹è‡ªåŠ¨éƒ¨ç½²çš„é­”æ³•å‘ç”Ÿï¼âœ¨

---

**ä¿®å¤æ—¶é—´**: çº¦ 5 åˆ†é’Ÿ  
**éš¾åº¦**: â­â˜†â˜†â˜†â˜† (éå¸¸ç®€å•)

