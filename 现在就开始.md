# ⚡ 立即开始部署 - 3步搞定！

## ✅ 已完成的准备工作

我已经为你创建了：
- ✅ GitHub Actions 自动部署工作流
- ✅ 完整的部署文档
- ✅ 故障排查指南

---

## 🎯 现在只需3步！

### 📝 第1步：配置 GitHub Secret（2分钟）⭐

这是**唯一**需要你手动配置的步骤！

#### 操作步骤：

1. **打开浏览器，访问这个链接**：
   ```
   https://github.com/djx-ux/-CICD/settings/secrets/actions
   ```

2. **点击右上角的 "New repository secret" 按钮**

3. **填写信息**：
   - **Name**: 输入 `SERVER_SSH_KEY`
   - **Secret**: 粘贴以下内容（完整复制）

```
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW
QyNTUxOQAAACD84jYWEqraE9+rb6uToRbGMHnxN9fgbXhdSLX79bpPHwAAAKAycg75MnIO
+QAAAAtzc2gtZWQyNTUxOQAAACD84jYWEqraE9+rb6uToRbGMHnxN9fgbXhdSLX79bpPHw
AAAEA6S7x5izDScoc1KdDCf/1jNa9lLCf0dEdoxMF74g33bPziNhYSqtoT36tvq5OhFsYw
efE31+BteF1Itfv1uk8fAAAAFnlvdXJfZW1haWxAZXhhbXBsZS5jb20BAgMEBQYH
-----END OPENSSH PRIVATE KEY-----
```

4. **点击 "Add secret"** 保存

✅ **完成标志**：你会在 Secrets 列表中看到 `SERVER_SSH_KEY`

---

### 📝 第2步：准备服务器（1分钟）

打开终端，运行：

```bash
# 连接到服务器
ssh root@119.29.95.149

# 创建部署目录
mkdir -p /opt/gin-vue-admin

# 检查 Docker（应该已安装）
docker --version

# 退出
exit
```

✅ **完成标志**：看到 Docker 版本号

---

### 📝 第3步：推送代码（1分钟）🚀

在终端运行（确保在项目目录）：

```bash ..
# 添加所有文件
git add .

# 提交
git commit -m "feat: 启用自动化CI/CD部署"

# 推送（触发自动部署）
git push origin main
```

---

## 📊 观察部署（3-5分钟）

推送后，立即访问：
```
https://github.com/djx-ux/-CICD/actions
```

你会看到 **"部署到腾讯云服务器"** 工作流正在运行！

部署过程：
1. ✅ 代码检查和测试（1分钟）
2. ✅ SSH 连接服务器（10秒）
3. ✅ 同步代码文件（30秒）
4. ✅ 构建 Docker 镜像（2分钟）
5. ✅ 部署新容器（30秒）
6. ✅ 验证部署（10秒）

---

## 🌐 访问应用

部署完成后（GitHub Actions 显示绿色✓），打开浏览器：

- **前端**: http://119.29.95.149:8080
- **后端**: http://119.29.95.149:8888

---

## ✅ 验证成功

在服务器上检查：

```bash
# SSH 到服务器
ssh root@119.29.95.149

# 查看容器（应该都是 Up 状态）
docker ps

# 输出示例：
# CONTAINER ID   IMAGE          STATUS          PORTS
# xxxxx          gva-web        Up 2 minutes    0.0.0.0:8080->8080/tcp
# xxxxx          gva-server     Up 2 minutes    0.0.0.0:8888->8888/tcp
# xxxxx          gva-mysql      Up 2 minutes    0.0.0.0:13306->3306/tcp
# xxxxx          gva-redis      Up 2 minutes    0.0.0.0:16379->6379/tcp
```

如果都是 `Up` 状态，**恭喜部署成功！** 🎉

---

## 🔥 可能遇到的问题

### ❌ GitHub Actions 失败 - SSH 错误

**错误**: `Permission denied (publickey)`

**原因**: SSH 密钥配置不正确

**解决**:
1. 重新检查 GitHub Secret `SERVER_SSH_KEY`
2. 确保包含 `-----BEGIN OPENSSH PRIVATE KEY-----` 和 `-----END OPENSSH PRIVATE KEY-----`
3. 确保没有多余空格或换行

### ❌ 容器无法访问

**检查腾讯云安全组**:
1. 登录腾讯云控制台
2. 云服务器 → 找到你的服务器
3. 安全组 → 确保开放端口：
   - **8080**（前端）
   - **8888**（后端）
   - **22**（SSH）

### ❌ 容器未启动

```bash
# SSH 到服务器
ssh root@119.29.95.149

# 查看容器状态
docker ps -a

# 查看日志
docker logs gva-web
docker logs gva-server

# 手动启动
cd /opt/gin-vue-admin/deploy/docker-compose
docker-compose up -d
```

---

## 🔄 后续使用

每次更新代码，只需：

```bash
# 1. 修改代码...

# 2. 提交并推送
git add .
git commit -m "feat: 新功能"
git push origin main

# 3. 等待3-5分钟自动部署

# 4. 刷新浏览器查看更新
```

就这么简单！🚀

---

## 📞 需要帮助？

- **GitHub Actions**: https://github.com/djx-ux/-CICD/actions
- **详细文档**: 查看 `部署步骤.md`
- **服务器日志**: `ssh root@119.29.95.149` → `docker logs gva-web`

---

## 🎯 快速命令

```bash
# 连接服务器
ssh root@119.29.95.149

# 查看容器
docker ps

# 查看日志
docker logs -f gva-web
docker logs -f gva-server

# 重启服务
docker restart gva-web
docker restart gva-server

# 查看资源使用
docker stats
```

---

## 🎉 总结

你现在拥有：

✅ **自动化部署** - 推送代码即自动部署  
✅ **实时反馈** - GitHub Actions 显示进度  
✅ **快速回滚** - Git revert 即可回滚  
✅ **便捷管理** - SSH 随时查看状态  

---

## 🚀 准备好了吗？

### 现在就开始第1步！

👉 **配置 GitHub Secret**

访问：https://github.com/djx-ux/-CICD/settings/secrets/actions

添加 `SERVER_SSH_KEY`（使用上面提供的私钥内容）

配置完成后，继续第2步和第3步，你的应用就会自动部署到服务器！

---

**预计总时间**: 4-8分钟  
**配置难度**: ⭐☆☆☆☆ (非常简单)  
**自动化程度**: ⭐⭐⭐⭐⭐ (完全自动)

**Let's Go! 🚀**

